<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<style>
body {
  font-family: Helvetica, arial, sans-serif;
  font-size: 14px;
  line-height: 1.6;
  padding-top: 10px;
  padding-bottom: 10px;
  background-color: white;
  padding: 30px; }

body > *:first-child {
  margin-top: 0 !important; }
body > *:last-child {
  margin-bottom: 0 !important; }

a {
  color: #4183C4; }
a.absent {
  color: #cc0000; }
a.anchor {
  display: block;
  padding-left: 30px;
  margin-left: -30px;
  cursor: pointer;
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0; }

h1, h2, h3, h4, h5, h6 {
  margin: 20px 0 10px;
  padding: 0;
  font-weight: bold;
  -webkit-font-smoothing: antialiased;
  cursor: text;
  position: relative; }

h1:hover a.anchor, h2:hover a.anchor, h3:hover a.anchor, h4:hover a.anchor, h5:hover a.anchor, h6:hover a.anchor {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA09pVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoMTMuMCAyMDEyMDMwNS5tLjQxNSAyMDEyLzAzLzA1OjIxOjAwOjAwKSAgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OUM2NjlDQjI4ODBGMTFFMTg1ODlEODNERDJBRjUwQTQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OUM2NjlDQjM4ODBGMTFFMTg1ODlEODNERDJBRjUwQTQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo5QzY2OUNCMDg4MEYxMUUxODU4OUQ4M0REMkFGNTBBNCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo5QzY2OUNCMTg4MEYxMUUxODU4OUQ4M0REMkFGNTBBNCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsQhXeAAAABfSURBVHjaYvz//z8DJYCRUgMYQAbAMBQIAvEqkBQWXI6sHqwHiwG70TTBxGaiWwjCTGgOUgJiF1J8wMRAIUA34B4Q76HUBelAfJYSA0CuMIEaRP8wGIkGMA54bgQIMACAmkXJi0hKJQAAAABJRU5ErkJggg==) no-repeat 10px center;
  text-decoration: none; }

h1 tt, h1 code {
  font-size: inherit; }

h2 tt, h2 code {
  font-size: inherit; }

h3 tt, h3 code {
  font-size: inherit; }

h4 tt, h4 code {
  font-size: inherit; }

h5 tt, h5 code {
  font-size: inherit; }

h6 tt, h6 code {
  font-size: inherit; }

h1 {
  font-size: 28px;
  color: black; }

h2 {
  font-size: 24px;
  border-bottom: 1px solid #cccccc;
  color: black; }

h3 {
  font-size: 18px; }

h4 {
  font-size: 16px; }

h5 {
  font-size: 14px; }

h6 {
  color: #777777;
  font-size: 14px; }

p, blockquote, ul, ol, dl, li, table, pre {
  margin: 15px 0; }

hr {
  background: transparent url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAECAYAAACtBE5DAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OENDRjNBN0E2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OENDRjNBN0I2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4Q0NGM0E3ODY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4Q0NGM0E3OTY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PqqezsUAAAAfSURBVHjaYmRABcYwBiM2QSA4y4hNEKYDQxAEAAIMAHNGAzhkPOlYAAAAAElFTkSuQmCC) repeat-x 0 0;
  border: 0 none;
  color: #cccccc;
  height: 4px;
  padding: 0;
}

body > h2:first-child {
  margin-top: 0;
  padding-top: 0; }
body > h1:first-child {
  margin-top: 0;
  padding-top: 0; }
  body > h1:first-child + h2 {
    margin-top: 0;
    padding-top: 0; }
body > h3:first-child, body > h4:first-child, body > h5:first-child, body > h6:first-child {
  margin-top: 0;
  padding-top: 0; }

a:first-child h1, a:first-child h2, a:first-child h3, a:first-child h4, a:first-child h5, a:first-child h6 {
  margin-top: 0;
  padding-top: 0; }

h1 p, h2 p, h3 p, h4 p, h5 p, h6 p {
  margin-top: 0; }

li p.first {
  display: inline-block; }
li {
  margin: 0; }
ul, ol {
  padding-left: 30px; }

ul :first-child, ol :first-child {
  margin-top: 0; }

dl {
  padding: 0; }
  dl dt {
    font-size: 14px;
    font-weight: bold;
    font-style: italic;
    padding: 0;
    margin: 15px 0 5px; }
    dl dt:first-child {
      padding: 0; }
    dl dt > :first-child {
      margin-top: 0; }
    dl dt > :last-child {
      margin-bottom: 0; }
  dl dd {
    margin: 0 0 15px;
    padding: 0 15px; }
    dl dd > :first-child {
      margin-top: 0; }
    dl dd > :last-child {
      margin-bottom: 0; }

blockquote {
  border-left: 4px solid #dddddd;
  padding: 0 15px;
  color: #777777; }
  blockquote > :first-child {
    margin-top: 0; }
  blockquote > :last-child {
    margin-bottom: 0; }

table {
  padding: 0;border-collapse: collapse; }
  table tr {
    border-top: 1px solid #cccccc;
    background-color: white;
    margin: 0;
    padding: 0; }
    table tr:nth-child(2n) {
      background-color: #f8f8f8; }
    table tr th {
      font-weight: bold;
      border: 1px solid #cccccc;
      margin: 0;
      padding: 6px 13px; }
    table tr td {
      border: 1px solid #cccccc;
      margin: 0;
      padding: 6px 13px; }
    table tr th :first-child, table tr td :first-child {
      margin-top: 0; }
    table tr th :last-child, table tr td :last-child {
      margin-bottom: 0; }

img {
  max-width: 100%; }

span.frame {
  display: block;
  overflow: hidden; }
  span.frame > span {
    border: 1px solid #dddddd;
    display: block;
    float: left;
    overflow: hidden;
    margin: 13px 0 0;
    padding: 7px;
    width: auto; }
  span.frame span img {
    display: block;
    float: left; }
  span.frame span span {
    clear: both;
    color: #333333;
    display: block;
    padding: 5px 0 0; }
span.align-center {
  display: block;
  overflow: hidden;
  clear: both; }
  span.align-center > span {
    display: block;
    overflow: hidden;
    margin: 13px auto 0;
    text-align: center; }
  span.align-center span img {
    margin: 0 auto;
    text-align: center; }
span.align-right {
  display: block;
  overflow: hidden;
  clear: both; }
  span.align-right > span {
    display: block;
    overflow: hidden;
    margin: 13px 0 0;
    text-align: right; }
  span.align-right span img {
    margin: 0;
    text-align: right; }
span.float-left {
  display: block;
  margin-right: 13px;
  overflow: hidden;
  float: left; }
  span.float-left span {
    margin: 13px 0 0; }
span.float-right {
  display: block;
  margin-left: 13px;
  overflow: hidden;
  float: right; }
  span.float-right > span {
    display: block;
    overflow: hidden;
    margin: 13px auto 0;
    text-align: right; }

code, tt {
  margin: 0 2px;
  padding: 0 5px;
  white-space: nowrap;
  border: 1px solid #eaeaea;
  background-color: #f8f8f8;
  border-radius: 3px; }

pre code {
  margin: 0;
  padding: 0;
  white-space: pre;
  border: none;
  background: transparent; }

.highlight pre {
  background-color: #f8f8f8;
  border: 1px solid #cccccc;
  font-size: 13px;
  line-height: 19px;
  overflow: auto;
  padding: 6px 10px;
  border-radius: 3px; }

pre {
  background-color: #f8f8f8;
  border: 1px solid #cccccc;
  font-size: 13px;
  line-height: 19px;
  overflow: auto;
  padding: 6px 10px;
  border-radius: 3px; }
  pre code, pre tt {
    background-color: transparent;
    border: none; }

sup {
    font-size: 0.83em;
    vertical-align: super;
    line-height: 0;
}
* {
	-webkit-print-color-adjust: exact;
}
@media screen and (min-width: 914px) {
    body {
        width: 854px;
        margin:0 auto;
    }
}
@media print {
	table, pre {
		page-break-inside: avoid;
	}
	pre {
		word-wrap: break-word;
	}
}
</style>
<title>Georeferencing imagery and digitizing data</title>

</head>
<body>
<h1>Georeferencing imagery and digitizing data</h1>

<hr />

<h1>Table of Contents</h1>

<!-- MarkdownTOC autolink="true" autoanchor="true" bracket="round" depth=0 -->


<ul>
<li><a href="#lesson-05-overview">Lesson 05 overview</a></li>
<li><a href="#lesson-05-data-files">Lesson 05 data files</a></li>
<li><a href="#introduction">Introduction</a>

<ul>
<li><a href="#gdal-and-ogr">GDAL and OGR</a></li>
<li><a href="#georeferencing">Georeferencing</a></li>
<li><a href="#adding-a-base-map">Adding a base map</a>

<ul>
<li><a href="#using-tile-server-xyz">Using Tile Server (XYZ)</a></li>
</ul>
</li>
<li><a href="#using-the-gdal-georeferencer">Using the GDAL Georeferencer</a></li>
</ul>
</li>
<li><a href="#digitizing-data">Digitizing Data</a>

<ul>
<li><a href="#digitizing-data-in-open-street-map">Digitizing data in Open Street Map</a>

<ul>
<li><a href="#digitizing-data-using-qgis">Digitizing data using QGIS</a></li>
<li><a href="#advanced-digitizing-in-qgis">Advanced digitizing in QGIS</a></li>
<li><a href="#finishing-a-digitizing-session">Finishing a digitizing session</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#addendum-georeferencing-the-rumsey-collection">Addendum: Georeferencing The Rumsey Collection</a></li>
</ul>


<!-- /MarkdownTOC -->


<p><a name="lesson-05-overview"></a></p>

<h1>Lesson 05 overview</h1>

<p>This module is a bit of departure from our previous weeks and we'll take a short break from SQL. We'll introduce the process of georeferencing an image (either aerial, satellite, or a static image) to align it to real-world locations. A georeferenced image can be used as a raster layer in our GIS. The module explores techniques for creating and editing new vector geometries using this imagery.</p>

<p>The module also introduces you to two significant online mapping resources:</p>

<ul>
<li><a href="http://www.openstreetmap.org">OpenStreetMap</a> for displaying base maps and digitizing new features on a shared map.</li>
<li><a href="http://www.davidrumsey.com/home">David Rumsey Historical Map Collection</a> is a map library where a visitor can georeference historical maps. We discuss this in the addendum.</li>
</ul>


<p>After this lesson, you'll be able to:</p>

<ul>
<li>georeference an image</li>
<li>create new vector data</li>
</ul>


<p><a name="lesson-05-data-files"></a></p>

<h1>Lesson 05 data files</h1>

<p>The images were created by University of Kentucky Geography department (balloon photography), and the vector file was provided by UK's Facilities Management Information Services.</p>

<p>CampusSidewalkLesson.zip</p>

<ul>
<li>sidewalk.jpg (not georeferenced)</li>
<li>sidewalk-geo.tif (georeferenced)</li>
<li>UK_SideWalks.shp</li>
</ul>


<p><a name="introduction"></a></p>

<h1>Introduction</h1>

<p>In previous modules, we have been using data from other sources, but the awesome capacity of being a map maker is making your data. To that end, we'll be georeferencing a photograph from a balloon camera image, creating a GIS raster layer from this image, and then digitizing new vector data from this layer. This workflow of creating new vector data from aerial or remotely sensed imagery has long generated much of data we use in our maps today.</p>

<p><a name="gdal-and-ogr"></a></p>

<h2>GDAL and OGR</h2>

<p>The <a href="http://www.gdal.org/">Geospatial Data Abstraction Library (GDAL)</a> is an open source library for reading and writing raster format geospatial data developed by the <a href="http://www.osgeo.org/">Open Source Geospatial Foundation (OSGeo)</a>. As we know, OSGeo is behind the development of QGIS. The vector corollary of GDAL is OGR, which interestingly enough doesn't stand for anything. It used to stand for <em>OpenGIS Simple Features Reference Implementation</em>, but it's no longer compliant with that data standard. So the name is just OGR, typically pronounced "ogre," as in a man-eating giant. You'll see these two libraries referenced in the names of QGIS plugins and geospatial tools across the field. It is the use of these two libraries that allow geospatial programs to read and write in multiple geospatial formats.</p>

<p><a name="georeferencing"></a></p>

<h2>Georeferencing</h2>

<p>Georeferencing adds real-world coordinates to raster layers, such as scanned maps, remotely sensed imagery, and aerial photography. This lesson will georeference a photo of University of Kentucky's central campus made from tethered ballon. The process has a few essential considerations:</p>

<ul>
<li>Locating control points in the image that correspond to know locations.</li>
<li>The transformation method that determines how much we alter the image to fit the control points to these known locations.</li>
<li>Selecting the right coordinate reference system can help minimize the alteration of the image.</li>
</ul>


<p>The raster layer that is to be georeferenced must have observable points to which we can either explicitly add X,Y coordinates or find the same location on a spatial layer, such as Google Maps or own spatial data. These are called ground control points (GCPSs) and the more defined, the better the outcome.</p>

<p>The transformation determines how much we can alter the original raster during georeferencing. Some transformation will only scale or rotate the raster (first order polynomial) while others will do sophisticated warping across the raster (Thin plate spline). The most popular and one the fastest transformations is the second order Polynomial algorithm, which allows for some warping but not as much as the Thin plate spline. In this lesson and lab we use the Thin plate spline transformation to georeference a low altitude aerial photograph and an old map.</p>

<p>If we are warping our raster, we need to pay attention to the method used to resample pixels. If our original raster layer was a scanned map of land cover with discrete classes (e.g., dark green represents evergreen forest, blue represents water, etc...) we would select the "Nearest Neighbor" resampling method. If our raster was a photograph showing a continuous phenomena, we would select the "Cubic" resampling method. We can see these different settings at work in the lesson video.</p>

<p>Selecting the right coordinate reference system depends on your raster layer you want to georeference. If the raster is an aerial photograph, it often doesn't have a CRS. The source spatial layer used for georeferencing will have a CRS, which the aerial photograph will inherit. If you are georeferencing a scanned map, then you should investigate what projection the map is using. You can then set up a georeferencing session using the map's CRS. We show how to georeference aerial photos and old maps in the lesson video.</p>

<p><a name="adding-a-base-map"></a></p>

<h2>Adding a base map</h2>

<p>Please enable the <a href="https://plugins.qgis.org/plugins/openlayers_plugin/">OpenLayers</a> in your Plugin Manager. It provides a base map service in QGIS from Google, Bing, Mapquest, OSM, and others. Once installed, find the base map options under QGIS's menu <strong>Web > OpenLayers</strong>.  Add Google satellite base map and let's compare it to our imagery.</p>

<p><a name="using-tile-server-xyz"></a></p>

<h3>Using Tile Server (XYZ)</h3>

<p>QGIS (2.18) now has a functionality similar to OpenLayers found in the <strong>Browser Panel</strong>, and sometimes is quicker rendering tiles in Map Canvas. Right-click <strong>Tile Server (XYZ)</strong> and enter a URL for a raster tile set and then a good name to remember this base map. A good source of free tile sets can be found in the <a href="https://leaflet-extras.github.io/leaflet-providers/preview/">Leaflet-providers plugin</a> (look for the URL in "L.tileLayer" variable).</p>

<p>For example, if you wanted an aerial photograph base map, use the following URL:</p>

<p>http://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}</p>

<p><a name="using-the-gdal-georeferencer"></a></p>

<h2>Using the GDAL Georeferencer</h2>

<p>Please enable the <a href="http://docs.qgis.org/2.18/en/docs/user_manual/plugins/plugins_georeferencer.html">GDAL Georeferencer</a> in your Plugin Manager. GDAL Georeferencer uses the GDAL library to facilitate the manipulation of an image to fit within a specified coordinate system and adds that geospatial information to the image, creating a <strong>GeoTIFF</strong> raster layer.</p>

<p>You can see the functional difference between a GeoTIFF and an unreferenced image by adding the provided files, <em>sidewalk.jpg</em> and <em>sidewalk-geo.tif</em> to a new project in QGIS using the <strong>Add Raster Layer</strong> option and then using the OpenLayers plugin, under the Web menu, to bring in the Google Satellite layer. If you zoom to the <em>sidewalk-geo.tiff</em> image, you'll find it lines itself up pretty well with the sidewalk outside of Patterson Office Tower on the University of Kentucky's campus.</p>

<p><img src="module-05-graphics/q00-google-base-map.jpg" alt="image of the sidewalk GeoTIFF placed over Google imagery" /> <br/>
Figure 01: Image of the sidewalk GeoTIFF placed over Google imagery</p>

<p>The <em>sidewalk.jpg</em> image is an unreferenced copy of the same image and it contains no coordinate information with which the GIS can place its size or location. Therefore, when loaded into QGIS, it appears floating around off the coast of Africa. Sidetone: the spot where the <em>sidewalk.jpeg</em> appears is the point where the Equator crosses the Prime Meridian at latitude 0 degrees and longitude 0 degrees. The nickname for this spot is <a href="http://www.nullisland.com/">Null Island</a>, and some maps even show a fictional island on that location.  In general, if your data is showing up at Null Island, it's an indication that there's something is terribly wrong, unless of course you are mapping 0,0.</p>

<p>Go ahead and remove <em>sidewalk.jpg</em> from the map. We'll bring it back in through the GDAL Georeferencer tool to align it within a given coordinate system. When you add an OpenLayers map, enable the OpenLayers Overview window to help locate your area of interest. It might help to add a spatial layer the covers your area of interest since you could then <strong>Zoom to Layer</strong>. Consider using the <strong>Filter...</strong> to isolate Fayette County, Kentucky for this lesson.</p>

<p><img src="module-05-graphics/_OpenLayersWindow.png" alt="image of the blank georeferencer screen" /> <br/>
Figure 02: OpenLayers view of Lexington</p>

<p>With the GDAL Georeferencer enabled in your plugin manager, you can access it by clicking <strong>Raster > Georeferencer > Georeferencer</strong>. Click on the raster icon in the upper left corner of the <strong>Georeferencer</strong> window and then browse to select the <em>sidewalk.jpg</em> file as the raster image to open.</p>

<p><img src="module-05-graphics/georeferencerscreen.png" alt="image of the blank georeferencer screen" />  <br/>
Figure 03: Starting the Georeferencer</p>

<p>The application will ask you to specify a CRS for this image. Georeferencing allows you to take an image in one coordinate system and after selecting a number of reference points, transform it to another coordinate system. In the case of an image of a map, you would supply the coordinate system the map was made in, or if you didn't know what it was, you'd make an educated guess based on the location depicted on the map and the time period in which it was made. We're trying to georeference a photograph taken with a digital camera suspended from a 5.5' weather balloon; the image was never projected. We're going to select CRS 3857, WGS84/Pseudo Mercator, the projection of the Google Satellite image we're referencing it against.</p>

<p>Once you've got the image loaded into Georeferencer, this is what you should see.</p>

<p><img src="module-05-graphics/loadedrasters.png" alt="image of the sidewalk jpeg loaded into georeferencer" /> <br/>
Figure 04: Loading the sidewalk.jpg into the Georeferencer</p>

<p>We're going to add ground control points, GCPs, that match the same point in our non-georeferenced image with the base map to which we're referencing. We'll do this by clicking the <strong>Add Point</strong> icon and then clicking on a recognizable point in the image. In the case of the provided image, the corners of the distinctive sidewalk paths are your best bet.</p>

<p>Once you've created your point, a small pop-up window will ask you to name the matching coordinates in the base map. This would work if we were georeferencing to something that had a coordinate grid on it, but for us it'll be easier to make the selection from the map canvas. Clicking on the <strong>Select from map canvas</strong> icon will open the main QGIS browser window. Locate the same point you identified previously on the Google Satellite image base map and click to set the point. Keep selecting reference points until you have at least 5 of them distributed across the page. Remember, more points makes the process more accurate. If you need to delete a point or move one, there are icons beside the Add Point icon that will facilitate that. If you lose your arrow while panning and zooming, you'll need to click the <strong>Select from map canvas</strong> button again. It's probably hiding under the main QGIS window. You should also make a Spatial Bookmark for the area of interest.</p>

<p>When you've finished adding your control points, click the <strong>Start georeferencing</strong> icon.</p>

<p><img src="module-05-graphics/startgeoreferencing.png" alt="image of the georeferencer tool loaded with GCPs and ready to start" />  <br/>
Figure 05: Control points in Georeferencer</p>

<p>Within the warning window asking you to set the transformation type,  choose the default "Thin Plate Spline." Name the output raster file, first clicking on the <strong>Browse</strong> button and selecting the location on your drive. Also set the Target SRS, which will again be EPSG: 3857. When finished, click <strong>Okay</strong>.</p>

<p><img src="module-05-graphics/_GeoreferenceParameters.png" alt="image of the georeferencer transformation settings window" />  <br/>
Figure 06: Transformation settings</p>

<p>The output is shown below and pretty close!</p>

<p><img src="module-05-graphics/_GeoreferenceOutput.png" alt="image of the sidewalk geotiff placed over Google imagery but with black surrounding it" />
Figure 07: Final georeferenced image in QGIS</p>

<p>If you're displeased with the outcome, you can continue adding points and refine your georeferencing with Georeferencer. When you close the Georeferencer tool, you'll be asked to save your GCP references, these are your reference points. Save these in the same place as the image they refer to. You can reload this image and experiment with the tool's parameters without having to add ground control points.</p>

<p><a name="digitizing-data"></a></p>

<h1>Digitizing Data</h1>

<p>Now that we have our imagery georeferenced, what can we do with it? One important use is to trace and create new vector data layers. This process is known as digitizing. As we create new points, lines, and polygons we can add attributes that could be used to symbolize our features for finished mapping.</p>

<p>As recent as 20 years ago, digitizing consisted of a large specialized table that could record the location of cursor (aka puck) clicks. Poster-sized maps would be secured to this table and you would trace lines and manually click to add a location. Your head was down tracing the large paper that couldn't be zoomed. With the inexpensive cost of scanners and hard disk storage, we today use monitors and are "heads up" while adding vector features over a map image on screen.</p>

<p><a name="digitizing-data-in-open-street-map"></a></p>

<h2>Digitizing data in Open Street Map</h2>

<p>We're going to take a quick digital field trip to <a href="http://www.openstreetmap.org">OpenStreetMap</a>. OpenStreetMap is the world's largest crowdsourced, open source, mapping project. Think of it as the Wikipedia of Maps. It's also a great place to get experience in digitizing vector data while actually contributing to a map dataset that you're probably using everyday without knowing it.</p>

<p>Once you're on the OpenStreetMap page, you'll need to create a user account. Once you're logged in, you can edit the map in your browser. Select the <strong>Edit</strong> dropdown then <strong>Edit with iD</strong>. If this is your first time editing, please select and work the short <strong>Walkthrough demo</strong>. It will help explain the process of creating/editing features and the relative advantages of digitizing with point, line, and polygon features. You'll notice that in addition to creating the actual vector features on the map, a large part of creating data is adding the attribute information.</p>

<p>Once you've completed the walkthrough, choose a part of the world that you're familiar with and start editing. Use <a href="http://tagfinder.herokuapp.com/">Tagfinder</a> to look up the meaning of tags, or to verify which tag to use if you aren't certain. (Note: iD Editor doesn't appear to contain all the tags available in OSM. If you can't find the exact tag you want, use a slightly more general tag instead. For instance, you could use "shop" instead of "bike shop," if bike shop were unavailable.) We're going to be using downloaded OSM data in the next module, so this is your chance to get familiar with it in advance.</p>

<p>One thing to know about OpenStreetMap: All of your edits must be real. Adding false information to the map is known as "map vandalism" and is one of the few offenses for which users can be banned from the site. The data generated by OSM is used by thousands of mobile apps and websites, don't vandalize the map.</p>

<p><a name="digitizing-data-using-qgis"></a></p>

<h3>Digitizing data using QGIS</h3>

<p>Back in QGIS, we're going to use what we learned about digitizing in OSM to digitize trees from our georeferenced image. To create a new geometry layer, from the top menu bar click <strong>Layer > Create Layer > New Temporary Scratch Layer</strong>.</p>

<p><img src="module-05-graphics/q01-new-layer.png" alt="Create new layer from QGIS menu" /> <br/>
Figure 08: Create new layer from QGIS menu</p>

<p>We could create a number of new feature layers, e.g., Shapefile, SpatiaLite layer, etc. In our workflow, we'll create an empty temporary layer, add features with attributes, and when we're finished we will import the layer into a SpatiaLite database or export to a GeoJSON. The temporary layer gives us a little more flexibility, but it only exists in the current session of QGIS; when you close the program, the layers will be deleted. Let's create our first layer:</p>

<p><img src="module-05-graphics/q02-new-layer.png" alt="Specify new layer properties" /> <br/>
Figure 09: Specify new layer properties</p>

<p>You'll need first to decide whether your new layer will be point, line or polygon data (or multipart). For this layer, we'll use <strong>Point</strong>. Next, we need to set the CRS, which will be EPSG: 3857. Finally, give it a meaningful name,  "Campus_trees" or similar.</p>

<p>Now we have the opportunity to add fields to our attribute layer. Right-click the newly created layer to access <strong>Open Attribute Table > Add new field</strong>:</p>

<p><img src="module-05-graphics/q01-edit-attribute.png" alt="Add new field in attribute table" /> <br/>
Figure 10: Add new field in attribute table</p>

<p>We'll add a text field called "Species". Click <strong>OK</strong>:</p>

<p><img src="module-05-graphics/q03-new-attribute.png" alt="Add a new attribute, &quot;Species&quot;" /> <br/>
Figure 11: Add a new attribute, "Species"</p>

<p>We'll add a real number field called "DBH" (DBH or "diameter at breast height" is a standard measurement for tree mapping). Add it to your table and click <strong>Ok</strong>:</p>

<p><img src="module-05-graphics/q04-new-attribute.png" alt="Add a new attribute, &quot;DBH&quot;" /> <br/>
Figure 12: Add a new attribute, "DBH"</p>

<p>Let's add our first feature. In the Editing toolbar (below the main toolbar), or in the QGIS menu <strong>Edit</strong>, select <strong>Add Feature</strong>. This will turn your mouse pointer into a crosshair and allow you to add points where ever you click on the map. Click on one of the trees in the area that we georeferenced. A small menu box will popup listing the fields from our attribute table. Fill it in with a tree species and a value for the DBH. (We're just practicing the tool right now, so it doesn't matter what data you enter or for which tree, so long as the data type you enter matches the data type for the field.)</p>

<p><img src="module-05-graphics/q05-add-feature.png" alt="Adding attributes after placing a point" />  <br/>
Figure 13: Adding attributes after placing a point</p>

<p>Keep adding trees to the layer until you have 6 points. When you've finished adding your trees, click the <strong>Save Layer Edits</strong> icon in the Editing toolbar and then toggle off editing by right-clicking on the layer again and selecting <strong>Toggle Editing</strong>. You can delete or move points by turning on editing and using the <strong>Delete Selected</strong> and <strong>Move Feature</strong> tools, respectively, located in the Editing toolbar. Always remember to save your edits or they will be discarded.</p>

<p><a name="advanced-digitizing-in-qgis"></a></p>

<h3>Advanced digitizing in QGIS</h3>

<p>Do the same thing again to add line and polygon layers to digitize the paths and greenspace areas. You will need to create a new layer for each data type. You can edit multiple layers simultaneously by selecting the layer you wish to edit. The Editing toolbar options will change depending on the geometry type you're editing. The explanation of when to use lines versus polygons or points that was given in the OSM walkthrough, holds true here as well.</p>

<p>When you digitize lines and polygons, you also use the <strong>Add Feature</strong> to start a feature, using left-clicks to add vertices, and a right-click in end digitizing of that feature. The <strong>Edit Node</strong> tool will allow you to move individual vertices to reshape your feature.</p>

<p>As digitize multiple layers, you'll soon discover that you want to have features align perfectly with other layers. We calls this "Snapping" which controls how vertices are placed when we digitize. It is not enabled by default, but we can access it in QGIS's menu <strong>Settings > Sanpping Options</strong>:</p>

<p><img src="module-05-graphics/q06-editing-many-features.png" alt="Enabling Snapping options" />  <br/>
Figure 14: Enabling Snapping options</p>

<p>Controlling how vertices are placed will greatly minimize clean-up edits down the road; as they say, do it right the first time! The idea behind snapping is make features align with other features, e.g., with side walks, have line endpoints end on the segments of intersecting sidewalks. Or, having greenspace polygons edge match sidewalk polygons.</p>

<p>There is no simple solution since the need for snapping varies. Let's enable snapping and experiment with its options:</p>

<p><img src="module-05-graphics/q07-snapping.png" alt="Enabling Snapping options" />  <br/>
Figure 15: Enabling Snapping options</p>

<p>The general options to configure include:</p>

<ul>
<li><strong>Layer Selection</strong> controls if you snap to just currently select layer features are all visible features. This is how you would snap between layers. The "Advanced" setting will tightly control how you snap between layers</li>
<li><strong>Snap to</strong> controls if you snap to just a vertex, the segment in-between vertices, or both, or disable snapping.</li>
<li><strong>Tolernece</strong> defines how close you need to be to a feature to enable snapping; the larger the number, the easier it is to snap. If it's too large, you won't be able add new vertices in empty space.</li>
</ul>


<p>OK, just experiment with snapping and adding features. Digitizing takes contact experience with the tools to 'get a feel' for how it works. With our temporary layers, we can always create a few layers and practice before we make our best data.</p>

<p><a name="finishing-a-digitizing-session"></a></p>

<h3>Finishing a digitizing session</h3>

<p>When are done digitizing your temporary layers, <strong>Toggle Editing</strong> off, and save edits. You will need to either import into a spatial database or <strong>Save as...</strong> export to a GeoJSON. Temporary layers will be lost if you close QGIS before you save the temporary layers to permanent layers (though a plugin is available that automatically saves temporary layers).</p>

<p>You can always save and continuing editing layers as GeoJSON or in a database. GeoJSON layers cannot be edited in QGIS on Linux OS.</p>

<p><a name="addendum-georeferencing-the-rumsey-collection"></a></p>

<h1>Addendum: Georeferencing The Rumsey Collection</h1>

<p>We're going to go on a digital field trip to one of the world's most well-known map collections, the <a href="http://www.davidrumsey.com/home">David Rumsey Historical Map Collection</a>. The Rumsey Collection contains over 150,000 maps with over 61,000 of those available online. The collection is expansive; it contains four centuries worth of rare maps from all over the world. It's a little slice of cartophile heaven. Go ahead and take a brief stroll through the collection.</p>

<p>The Rumsey Collection is massive and it includes huge amounts of information that could be useful to people studying a broad range of topics, everything from toponymy to climate change. However, much of this imagery is saved in a raster format without encoded spatial reference information. Therefore the information within these maps is not immediately accessible within a GIS.</p>

<p>To make these maps and their content available for digital use, they need to be georeferenced. You can imagine with the number of maps that the Rumsey Collection contains that that would take a lot of time and money to do. So the Rumsey Collection has launched a project called Georeferencer to crowdsource the georeferencing of the collection. To get a feel for the georeferencing process, we're going to contribute to the project and georeference a few maps for them. Go ahead and open <a href="http://www.davidrumsey.com/view/georeferencer">Georeferencer</a>. There's a brief introduction video that explains how to use the tool before you're let loose on the maps. Georeference 2 to 3 maps for practice before moving on to the next portion of the module in QGIS.</p>

<p>Tips for improving your georeferencing results:</p>

<ul>
<li>3 points is an absolute minimum, more is better</li>
<li>Spreading the points evenly across the map helps</li>
<li>Zoom way in when placing your points, accuracy matters</li>
</ul>

</body>
</html>